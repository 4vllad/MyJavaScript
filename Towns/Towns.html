<html>
<head>
<title>Towns</title>
<style>
    body {
        font-size: 18px;
        font-family: Arial,Helvetica,sans-serif;
    }
     #respanel, #buttondiv, #buttondiv2, #buttondiv3,#buttondiv4, #world, #cheat{
          border: 2px solid;
          width: auto;
          background-color:gainsboro;
          visibility: hidden;
     }
     #respanel  {background-color: #a7a5e1;}
     #buttondiv {background-color: #b7dcb6;}
     #buttondiv2 {background-color: #b5dcd2;}
     #buttondiv3 {background-color: #dcb3b0 ;}
     #buttondiv4 {background-color: #dcd9b9;}
     #line21{color: yellow;}
     #line11{color: #000000;}
     #line31{color: #00f500;}
     #line71{color: #dd151f;}
     button {
         background-color: rgb(233, 233, 233);
         color: rgb(0, 0, 0);
         border-color: #000000;
         font-size: 18px;
         font-family: Arial,Helvetica,sans-serif;
     }
     .html {
         width:100%;
         margin: auto;
          }
    .div{
        border: 2px solid;
    }

     #canvas {
         style:"width: 50%; margin: auto;"
     }
</style>
</head>
<body>

<button id="start" onclick="start()">Start</button>
<div id="buttondiv" >
    <div id="div0"><span id="line01"></span><span id="line02"></span></div> <br>
</div>



<br>
<div id="respanel">
<div id="div1">&ensp;&ensp;&ensp;<span id="line11">
    </span>&ensp;<span id="line12"></span>&ensp;
    <button onclick="cutWood()" >Cut Wood</button>
    <button onclick="sell()" >Sell Wood</button>
    <span>Upgrade: </span></canvas>
    <button onclick="upgradeCutWood()">Upgrade Cutting</button>
    <span id="upgradeCutWood">Cost: 100g</span></canvas>
    <canvas id="woodCanvas" style="border: solid #000000 1px; float:right;position:relative; top: 2.5px; height: 15px; width:250px">
</div>
<div id="div2"> &emsp;
    <span id="line21"></span>&ensp;
    <span id="line22"></span>
</div>
<div id="div4"> &emsp;
    <span id="line41" style="float: contour "></span>
    &ensp;<span id="line42"></span>
    <span>&emsp; &emsp; <span id="line51"></span> &emsp;&emsp;&emsp;Upgrade:</span>&ensp;
    </span><span id="line52">
    </span><button onclick="buildHouse()">Build House</button>
    <span id="hint7"></span>
    <canvas id ="populationCanvas" style="border: solid mediumblue 1px; float: right; position: relative; height: 15px; width:250px"></canvas>
</div>
<div id="div3"> &emsp;
    <span id="line31"></span>
    &ensp;<span id="line32"></span>
    <button onclick="buyWoodcuters()">Buy Woodcuters</button>
    <span> Cost: 100g</span>
    <button onclick="sellWoodcuters()">Sell 1 Woodcuter</button>


</div>
<div id="div6"> &emsp;
    <span id="line61"></span>&ensp;
    <span id="line62"></span>&emsp;
    <button onclick="buildLifeSpark()">Fuse Life Spark</button>
    <span id="hint5"></span>
</div>
<div id="div7"> &emsp;
    <span id="line71"></span>
    &ensp;<span id="line72"></span>
    <button onclick="transformHeroHealth()" hidden>Transform Hero Health</button>
    <button id="transformAllHeroHealth" onclick="transformAllHeroHealth()">Transform ALL Hero Health</button>
    <span id="hint6"></span>
</div>




</div>
<br>
<div id="buttondiv2">

    <button onclick="upgradeStorage()">Upgrade Storage</button>
    <span id="woodStorageUpgradeCost">Cost: 10000g</span>
</div>
<br>
<div id="canvas">
    <canvas id="world" style="background: white" width="920" height="450" ></canvas>
</div>
<br>
<div id="buttondiv3">
    <button id="attack" onclick="attack()" >Charge!</button>
    <span> Cost: "1 life spark" Loot: "+ 1000 gold" </span>
    <br>
    <button id="inventory" onclick="stats()" hidden>Inventory</button>
</div>
<br>
<div id="buttondiv4">
    <button id="upgradePower" onclick="upgradePower()">Upgrade Power</button>
    <span> Cost: "All EXP" </span>
</div>

<br>
<br>

<div id="time" onclick="cheatsVisible()"></div>
<div id="cheat">
    <span>Cheats:</span>
    <button onclick="addGold()">Add Gold</button>
    <button id="cheat2" onclick="cheatHeroHealth()">More Hero Health</button>
    <button id="cheat4" onclick="cheatAttack()">More Attack</button>
    <button id="cheat3" onclick="visibleSaber()">???</button>
</div>
<div id="test2"></div>
</body>
<script>
    /**
     * @author Alex Dudin
     */
    function start() {
        document.getElementById("start").style.visibility="hidden";
        document.getElementById("respanel").style.visibility="visible";
        document.getElementById("buttondiv").style.visibility="visible";
        document.getElementById("buttondiv2").style.visibility="visible";
        document.getElementById("buttondiv3").style.visibility="visible";
        document.getElementById("buttondiv4").style.visibility="visible";
        document.getElementById("world").style.visibility="visible";

        document.getElementById("line01").innerHTML = "---Towns 0.5.2.1---";
        document.getElementById("line11").innerHTML = "wood: " + wood + "/" + woodStorage;
        document.getElementById("line21").innerHTML = "gold: 0";
        document.getElementById("line31").innerHTML = "woodcuter: 0";
        document.getElementById("line41").innerHTML = " population: 0/100";
        document.getElementById("line51").innerHTML = " houses: 0";
        document.getElementById("line61").innerHTML = " life sparks: 0";
        document.getElementById("line71").innerHTML = " Hero Health: 0";

        document.getElementById("hint5").innerHTML = " Cost: 100 wood per 1 life sparks:";
        document.getElementById("hint6").innerHTML = " Cost: 1 life sparks, 1 woodcuter for 10 Hero Health";
        document.getElementById("hint7").innerHTML = " Cost: 500 wood";

        document.getElementById("line12").innerHTML = " (..........)";
        document.getElementById("line42").innerHTML = " (..........)";
        timer();
    }

    function checkWindowSize() {

    }

    function timer(){
        document.getElementById("time").innerHTML = new Date();
        checkPopulation();
        checkWood();
        //checkWindowSize();
        setTimeout(timer,1000);
    }

    //Resources
    let wood = 0;
    let woodPerCut = 1;
    function cutWood() {
        wood = wood + woodPerCut;
        document.getElementById("line11").innerHTML = "wood: " + wood + "/" + woodStorage;
        if(wood <= woodStorage){
            playWoodAudio();
            clearCanvas();
            for (let i = 0; i < woodPerCut; i++){
                drawWoodImage(0);
            }
        }


    }

    //Gold
    var gold = 0;
    var lastGoldProfit = 0;
    function sell(){
        gold = gold + wood;
        lastGoldProfit = wood;
        wood = 0;
        document.getElementById("line21").innerHTML = "gold: " + gold;
        document.getElementById("line11").innerHTML = "wood: " + wood + "/" + woodStorage;
        playCoinAudio();
        clearCanvas();
        for (let i = 0; i < woodImageAmount;i++){
            woodImageArray.pop();
        }
        //playSound("audio/coins2.wav");

    }
    //Woodcuters
    let woodcuter = 0;
    let woodcuterMax = 100;
    let woodcuterCost = 100;
    function buyWoodcuters(){
        if (gold >= woodcuterCost && population < populationMax){
            let tempGold = gold;
            let restGold = gold%woodcuterCost;
            gold = 0;
            gold = gold + restGold;
            //var popdiff = populationMax - population; -> - popdiff
            woodcuter = woodcuter + (Math.floor(tempGold/woodcuterCost));
            if (woodcuter > woodcuterMax){
                let tempWoodcuter = woodcuter - woodcuterMax;
                woodcuter = woodcuter - tempWoodcuter;
                gold = gold + (tempWoodcuter*10);
            }

            population = woodcuter + heroHealth;
            if (population > populationMax){
                population = populationMax;
            }
            checkPopulationBar();
            document.getElementById("line21").innerHTML = "gold: " + gold;
            document.getElementById("line31").innerHTML = "woodcuter: " + woodcuter;
            document.getElementById("line41").innerHTML = " population: " + population + "/" + populationMax;
            if (woodcuter >= 50) {
                playWoodCuttersAudio();
            }
            else {
                playWoodCutterAudio();
            }

        }
    }

    function sellWoodcuters(){
        if(woodcuter > 0){
            woodcuter--;
            gold = gold +10;
            population = woodcuter + heroHealth;
            checkPopulationBar();
            document.getElementById("line21").innerHTML = "gold: " + gold;
            document.getElementById("line31").innerHTML = "woodcuter: " + woodcuter;
            document.getElementById("line41").innerHTML = " population: " + population + "/" + populationMax;

            playCoinAudio();
        }


    }
    //Population
    var population = 0;
    var populationMax = 100;
    //Check Functions
    //CheckWood
    function checkWood() {
        if (woodcuter > 0){
            wood = wood + woodcuter;
            document.getElementById("line11").innerHTML = "wood: " + wood + "/" + woodStorage;
        }
        if (wood >= woodStorage){
            wood = woodStorage;
            document.getElementById("line11").innerHTML = "wood: " + wood + "/" + woodStorage;
        }
        checkWoodBar();
    }
    
    //CheckPopulation
    function checkPopulation() {
        if (population > populationMax){
            population = populationMax;
            population = woodcuter + heroHealth;
            document.getElementById("line41").innerHTML = " population: " + population + "/" + populationMax;
        }
        checkPopulationBar();
    }


    //Upgrades

    //Upgrade Cut Wood
    let upgradeGoldCost = 100;
    let upgradeGoldCostMultiplikator = 1;
    let total = upgradeGoldCostMultiplikator * upgradeGoldCostMultiplikator;
    function upgradeCutWood() {
        if (gold >= (upgradeGoldCost * upgradeGoldCostMultiplikator)){
            woodPerCut = woodPerCut + 1;
            gold = gold - (upgradeGoldCost * upgradeGoldCostMultiplikator);
            upgradeGoldCostMultiplikator = upgradeGoldCostMultiplikator * 2;
            total = upgradeGoldCost * upgradeGoldCostMultiplikator;
            document.getElementById("upgradeCutWood").innerText = "Cost: " +  total + "g";
            document.getElementById("line21").innerHTML = "gold: " + gold;
            playUpgradeAxeAudio();
        }

    }

    //Upgrade  Storage
    var woodStorage = 1000;
    var woodUpgradeCost = 10000;
    function upgradeStorage() {

        if (gold > woodUpgradeCost){
            woodStorage = woodStorage*10;
            gold = gold - woodUpgradeCost;
            document.getElementById("line21").innerHTML = "gold: " + gold;
            document.getElementById("line11").innerHTML = "wood: " + wood + "/" + woodStorage;
            woodUpgradeCost = woodUpgradeCost * 10;
            document.getElementById("woodStorageUpgradeCost").innerHTML ="Cost: " + woodUpgradeCost + "g";
        }
    }

    //Build a Life Spark
    var lifeSpark = 0;
    var lifeSparkCost = 100;
    function buildLifeSpark() {
        if (wood >= lifeSparkCost){
            let lifeSparkCostTotal = Math.floor(wood  / lifeSparkCost);
            //console.log(lifeSparkCostTotal);
            lifeSpark = lifeSpark + lifeSparkCostTotal;
            //console.log(lifeSpark);
            wood -= lifeSparkCostTotal * 100;
            //console.log(wood);

            checkWoodBar();
            document.getElementById("line61").innerHTML = " life Spark: " + lifeSpark;
            document.getElementById("line11").innerHTML = "wood: " + wood + "/" + woodStorage;
        }
    }

    //Transform life sparks to Hero Health
    var heroHealth = 0;
    let difficulty = 10; // 10 = easy ; 1 = hard
    function transformHeroHealth() {
        if (lifeSpark > 0){
            lifeSpark--;
            heroHealth = heroHealth + difficulty;//heroHealth++;
            playerHealth = heroHealth;

            document.getElementById("line61").innerHTML = " life Sparks: " + lifeSpark;
            document.getElementById("line31").innerHTML = "woodcuter: " + woodcuter;
            document.getElementById("line71").innerHTML = " Hero Health: " + heroHealth;


            worldCtx.fillStyle= "black";
            clearCanvas();
            drawCircle();
            drawPlayerStats();
            drawGround();
            drawRightGuy(0); //Right Guy
            drawLeftGuy(0) //Left Guy
        }
    }

    function transformAllHeroHealth() {
        if (lifeSpark > 0){
                heroHealth = heroHealth + (lifeSpark * difficulty);
                lifeSpark = 0;
            }
            playerHealth = heroHealth;

            document.getElementById("line61").innerHTML = " life Sparks: " + lifeSpark;
            document.getElementById("line71").innerHTML = " Hero Health: " + heroHealth;


            worldCtx.fillStyle= "black";
            clearCanvas();
            drawCircle();
            drawPlayerStats();
            drawGround();
            drawRightGuy(0); //Right Guy
            drawLeftGuy(0) //Left Guy

    }


    //Build a House
    var house = 0;
    var houseCost = 500;
    function buildHouse() {
        if (wood >= houseCost){
          wood = wood - houseCost;
          house = house + 1;
          checkWoodBar();
          document.getElementById("line51").innerHTML = " houses: " + house;
          woodcuterMax = woodcuterMax + 10
          document.getElementById("line31").innerHTML = "woodcuter: " + woodcuter;
          populationMax = populationMax +10;
          document.getElementById("line41").innerHTML = " population: " + population + "/" + populationMax;
          clearCanvas();
          drawHouseImage(0);
          playHouseAudio();
        }
    }

    //Progressbars
    //Woodbar
    var woodCanvas = document.getElementById("woodCanvas");
    var woodCtx = woodCanvas.getContext("2d");
    woodCtx.fillStyle="saddlebrown";
    function checkWoodBar() {
        if (wood >= 0){
            document.getElementById("line12").innerHTML = " (..........)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0,150);
        }
        if  (wood >= woodStorage*0.1){
            document.getElementById("line12").innerHTML = " (|.........)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0.1,150);
        }
        if  (wood >= woodStorage*0.2){
            document.getElementById("line12").innerHTML = " (||........)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0.2,150);
        }
        if  (wood >= woodStorage*0.3){
            document.getElementById("line12").innerHTML = " (|||.......)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0.3,150);
        }
        if  (wood >= woodStorage*0.4){
            document.getElementById("line12").innerHTML = " (||||......)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0.4,150);
        }
        if  (wood >= woodStorage*0.5){
            document.getElementById("line12").innerHTML = " (|||||.....)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0.5,150);
        }
        if  (wood >= woodStorage*0.6){
            document.getElementById("line12").innerHTML = " (||||||....)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0.6,150);
        }
        if  (wood >= woodStorage*0.7){
            document.getElementById("line12").innerHTML = " (||||||...)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0.7,150);
        }
        if  (wood >= woodStorage*0.8){
            document.getElementById("line12").innerHTML = " (||||||||..)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0.8,150);
        }
        if  (wood >= woodStorage*0.9){
            document.getElementById("line12").innerHTML = " (|||||||||.)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*0.9,150);
        }
        if  (wood >= woodStorage){
            document.getElementById("line12").innerHTML = " (||||||||||)";
            woodCtx.clearRect(0,0,300*1,150);
            woodCtx.fillRect(0,0,300*1,150);

        }
    }
    
    //Populationbar
    var popCanvas = document.getElementById("populationCanvas");
    var popCtx = popCanvas.getContext("2d");
    popCtx.fillStyle = "mediumblue";
    function checkPopulationBar() {
        if (population >= 0){
            document.getElementById("line42").innerHTML = " (..........)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0,150);
        }
        if  (population >= populationMax*0.1){
            document.getElementById("line42").innerHTML = " (|.........)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0.1,150);
        }
        if  (population >= populationMax*0.2){
            document.getElementById("line42").innerHTML = " (||........)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0.2,150);
        }
        if  (population >= populationMax*0.3){
            document.getElementById("line42").innerHTML = " (|||.......)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0.3,150);
        }
        if  (population >= populationMax*0.4){
            document.getElementById("line42").innerHTML = " (||||......)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0.4,150);
        }
        if  (population >= populationMax*0.5){
            document.getElementById("line42").innerHTML = " (|||||.....)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0.5,150);
        }
        if  (population >= populationMax*0.6){
            document.getElementById("line42").innerHTML = " (||||||....)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0.6,150);
        }
        if  (population >= populationMax*0.7){
            document.getElementById("line42").innerHTML = " (||||||...)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0.7,150);
        }
        if  (population >= populationMax*0.8){
            document.getElementById("line42").innerHTML = " (||||||||..)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0.8,150);
        }
        if  (population >= populationMax*0.9){
            document.getElementById("line42").innerHTML = " (|||||||||.)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*0.9,150);
        }
        if  (population >= populationMax){
            document.getElementById("line42").innerHTML = " (||||||||||)";
            popCtx.clearRect(0,0,300*1,150);
            popCtx.fillRect(0,0,300*1,150);

        }
    }

    //World Canvas
    var world = document.getElementById("world");
    var worldCtx = world.getContext("2d");

    //Attack
    var xPositonLeftGuy = 80;
    var yPositonLeftGuy = 190;
    var widthLeftGuy = 80;
    var heightLeftGuy = 160;

    var xPositonRightGuy = 750;
    var yPositonRightGuy = 190;
    var widthRightGuy = 80;
    var heightRightGuy = 160;

    var yPositionGround = 350;


    function attack() {
        if(heroHealth > 0){
        //Draw
        clearCanvas();
        drawCircle(); // Sun
        drawStats(); // Player and Enemy Statistics
        drawGround(); //Background
        drawRightGuy(150); //Right Guy
        drawLeftGuy(150); //Left Guy

        playPunchAudio(); //Audio
        changeResources();


        
        if (heroHealth == 0){
            playDeathAudio();
            clearCanvas();
            drawCircle();
            //drawLeftGuy(0);

            drawGround();
            drawRightGuy(0); //Right Guy
            drawStats();
        }
        if (enemyHealth <= 0){
            worldCtx.fillText("Got em'" , 410, 200);
            playerExp = playerExp + (1 * enemyHealthMult/10);
            enemyHealth = 10; // Base Health
            enemyHealth = enemyHealth * enemyHealthMult; // Multiply by Multiplikator
            enemyHealthMult = enemyHealthMult * (50/difficulty); // Multiplay Multiplikator by 2
            bossCount++;
            document.getElementById("transformAllHeroHealth").style.visibility="visible";
            enemyAudio();
            clearCanvas();
            drawCircle();

            drawGround();
            drawLeftGuy(0);
            drawStats();
        }

        }

    }

    //Changes some Parameters after Attacking
    function changeResources() {
        gold = gold + 1000;
        document.getElementById("line21").innerHTML = "gold: " + gold;
        heroHealth = heroHealth - 1;
        document.getElementById("line71").innerHTML = " Hero Health: " + heroHealth;
        //population = population - 1;
        document.getElementById("line41").innerHTML = " population: " + population + "/" + populationMax;
        playerExp = playerExp + (1 + (bossCount * 1));
        enemyHealth = enemyHealth - playerPower;
        playerHealth = heroHealth;
    }

    //Draw Sun
    function drawCircle() {
        worldCtx.fillStyle = "orange";
        worldCtx.beginPath();
        worldCtx.arc(460,350,250,0,2*Math.PI);
        worldCtx.fill();
        worldCtx.stroke();
        worldCtx.fillStyle = "black";

    }

    //Draw the Ground
    function drawGround() {
        worldCtx.fillRect(0, yPositionGround ,920,600);
    }

    function enemyAudio(){
        if (bossCount > enemySoundArray.length){
            playSplatAudio();
        }
        else {
            playEnemySound(bossCount);
        }

    }
    let bossCount = 0;
    //Draw the enemy
    function drawRightGuy(x) {
        this.x = x;
        if (bossCount > enemyImageArray.length){
            //Do Nothing
        }
        else {
            drawEnemyImage(bossCount);
        }
        if (bossCount == 7){
            trumpSound.play();
        }
        if (bossCount == 8){
            trumpSound.pause();
        }
    }

    //Draw the Player
    function drawLeftGuy(x) {
        this.x = x;
        if (playerModel == true){
            if (saberVisibility == true){
                if(playerPower < 10000){
                    playerPower = playerPower + 10000;
                }
                drawSaber(x);
            }
            else {

            }
        }
        else {
            //worldCtx.fillRect(xPositonLeftGuy + x, yPositonLeftGuy, widthLeftGuy, heightLeftGuy);
            drawPlayerImage(x);
            rotateLeftGuy();
        }
    }


    //Clear the Battle Canvas
    function clearCanvas() {
        worldCtx.clearRect(0,0,920,1000);
    }

    

    

    // EVERYTHING UNDER THIS COMMENT SHOULD BE IN SEPERATE JAVASCRIPT FILES


</script>

<script src="audio.js"></script>
<script src="stats.js"></script>
<script src="pictures.js"></script>
<script src="townsGui.js"></script>
<script src="cheats.js"></script>
<script src="animation.js"></script>
</html>